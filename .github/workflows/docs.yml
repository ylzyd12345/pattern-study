name: Documentation

on:
  push:
    branches: [ main, master ]
    paths: [ 'docs/**', 'README.md', '**.md' ]
  pull_request:
    branches: [ main, master ]
    paths: [ 'docs/**', 'README.md', '**.md' ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pages: write
      id-token: write

    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Setup Java
      uses: actions/setup-java@v4
      with:
        java-version: '11'
        distribution: 'temurin'

    - name: Setup Pages
      uses: actions/configure-pages@v4

    - name: Build Javadoc
      run: |
        mvn javadoc:javadoc -Dnohelp=true -Dnotree=true -Dnoindex=true

    - name: Build Documentation
      run: |
        # Create docs directory
        mkdir -p target/site/docs
        
        # Copy markdown files
        cp README.md target/site/docs/index.md
        cp FAQ.md target/site/docs/faq.md
        cp CHANGELOG.md target/site/docs/changelog.md
        
        # Copy docs directory
        cp -r docs/* target/site/docs/
        
        # Generate navigation
        cat > target/site/docs/_navigation.md << 'EOF'
# å¯¼èˆª

## ðŸ“š ä¸»è¦æ–‡æ¡£
- [é¦–é¡µ](index.md)
- [å¸¸è§é—®é¢˜](faq.md)
- [æ›´æ–°æ—¥å¿—](changelog.md)

## ðŸŽ¯ è®¾è®¡æ¨¡å¼
- [å†³ç­–æ ‘](design-pattern-decision-tree.md)
- [æ€§èƒ½å¯¹æ¯”](performance-comparison.md)

## ðŸ—ï¸ åˆ›å»ºåž‹æ¨¡å¼
- [å•ä¾‹æ¨¡å¼](../creational/å•ä¾‹/singleton-pattern.md)
- [å·¥åŽ‚æ–¹æ³•](../creational/å·¥åŽ‚/factory-method-pattern.md)
- [æŠ½è±¡å·¥åŽ‚](../creational/æŠ½è±¡å·¥åŽ‚/abstract-factory-pattern.md)
- [å»ºé€ è€…æ¨¡å¼](../creational/å»ºé€ è€…/builder-pattern.md)
- [åŽŸåž‹æ¨¡å¼](../creational/åŽŸ/prototype-pattern.md)

## ðŸ”§ ç»“æž„åž‹æ¨¡å¼
- [é€‚é…å™¨æ¨¡å¼](../structural/é€‚é…/adapter-pattern.md)
- [æ¡¥æŽ¥æ¨¡å¼](../structural/æ¡¥/bridge-pattern.md)
- [ç»„åˆæ¨¡å¼](../structural/ç»„åˆ/composite-pattern.md)
- [è£…é¥°å™¨æ¨¡å¼](../structural/è£…é¥°/decorator-pattern.md)
- [å¤–è§‚æ¨¡å¼](../structural/å¤–è§‚/facade-pattern.md)
- [äº«å…ƒæ¨¡å¼](../structural/äº«å…ƒ/flyweight-pattern.md)
- [ä»£ç†æ¨¡å¼](../structural/ä»£ç†/proxy-pattern.md)

## ðŸŽ­ è¡Œä¸ºåž‹æ¨¡å¼
- [è´£ä»»é“¾æ¨¡å¼](../behavioral/è´£ä»»é“¾/chain-of-responsibility-pattern.md)
- [å‘½ä»¤æ¨¡å¼](../behavioral/å‘½ä»¤/command-pattern.md)
- [è§£é‡Šå™¨æ¨¡å¼](../behavioral/è§£é‡Š/interpreter-pattern.md)
- [è¿­ä»£å™¨æ¨¡å¼](../behavioral/è¿­ä»£/iterator-pattern.md)
- [ä¸­ä»‹è€…æ¨¡å¼](../behavioral/ä¸­ä»‹/mediator-pattern.md)
- [å¤‡å¿˜å½•æ¨¡å¼](../behavioral/å¤‡å¿˜å½•/memento-pattern.md)
- [è§‚å¯Ÿè€…æ¨¡å¼](../behavioral/è§‚å¯Ÿè€…/observer-pattern.md)
- [çŠ¶æ€æ¨¡å¼](../behavioral/çŠ¶æ€/state-pattern.md)
- [ç­–ç•¥æ¨¡å¼](../behavioral/ç­–ç•¥/strategy-pattern.md)
- [æ¨¡æ¿æ–¹æ³•æ¨¡å¼](../behavioral/æ¨¡æ¿/template-method-pattern.md)
- [è®¿é—®è€…æ¨¡å¼](../behavioral/è®¿é—®è€…/visitor-pattern.md)

## ðŸ§ª æµ‹è¯•æ–‡æ¡£
- [æµ‹è¯•è¦†ç›–çŽ‡](../target/site/jacoco/index.html)
- [æµ‹è¯•æŠ¥å‘Š](../target/surefire-reports/index.html)

## ðŸ”— é“¾æŽ¥
- [GitHubä»“åº“](https://github.com/ylzyd12345/pattern-study)
- [é—®é¢˜åé¦ˆ](https://github.com/ylzyd12345/pattern-study/issues)
EOF

    - name: Generate HTML with MkDocs
      uses: peaceiris/actions-mdbook@v1
      with:
        mdbook-version: '0.4.21'
        source-dir: 'target/site/docs'

    - name: Upload artifact
      uses: actions/upload-pages-artifact@v3
      with:
        path: 'target/site'

    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v4